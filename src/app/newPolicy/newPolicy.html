<!-- Navigation Bar -->
<div class="navbar-fullwidth">
<nav>
  <div class="navbar nav-container">
      <a routerLink="/" style="text-decoration: none;" class="logo">
      <h3>Star Protect Vehicle System</h3>
    </a>
    <ul class="nav-links">
      <li>
          <a routerLink="/dashboard" routerLinkActive="active">Underwriter Dashboard</a>
      </li>
    </ul>
  </div>
</nav>
</div>


<!-- Heading -->
<h2 class="animated-heading" style="font-size: 35px;" id="top-heading">
  Create a new Vehicle Insurance Policy
</h2>

<!-- Form Section -->
<div class="form-section">
  <div class="form-container">
    <form (ngSubmit)="submitForm()" #insuranceForm="ngForm">
      <div class="insurance-form">
        <div class="form-row">
          <div class="form-field-row">
            <label for="vehicleNo">Vehicle Number</label>
            <input type="text" id="vehicleNo" [(ngModel)]="form.vehicleNo" (ngModelChange)="validateForm()" name="vehicleNo" />
            <div class="error-message" *ngIf="errors['vehicleNo']">{{ errors['vehicleNo'] }}</div>
          </div>
          <div class="form-field-row">
            <label for="vehicleType">Vehicle Type</label>
            <select id="vehicleType" [(ngModel)]="form.vehicleType" name="vehicleType" (ngModelChange)="validateForm()">
              <option value="" disabled selected>Select Vehicle Type</option>
              <option value="2 Wheeler">2 Wheeler</option>
              <option value="4 Wheeler">4 Wheeler</option>
            </select>
            <div class="error-message" *ngIf="errors['vehicleType']">{{ errors['vehicleType'] }}</div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-field-row">
            <label for="customerName">Customer Name</label>
            <input type="text" id="customerName" [(ngModel)]="form.customerName" (ngModelChange)="validateForm()" name="customerName" />
            <div class="error-message" *ngIf="errors['customerName']">{{ errors['customerName'] }}</div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-field-row">
            <label for="engineNo">Engine Number</label>
            <input type="text" id="engineNo" [(ngModel)]="form.engineNo" (ngModelChange)="validateForm()" name="engineNo" />
            <div class="error-message" *ngIf="errors['engineNo']">{{ errors['engineNo'] }}</div>
          </div>

          <div class="form-field-row">
            <label for="chassisNo">Chassis Number</label>
            <input type="text" id="chassisNo" [(ngModel)]="form.chassisNo" (ngModelChange)="validateForm()" name="chassisNo" />
            <div class="error-message" *ngIf="errors['chassisNo']">{{ errors['chassisNo'] }}</div>
          </div>
        </div>

        <div class="form-row">
        <div class="form-field-row">
            <label for="insuranceType">Insurance Type</label>
            <select id="insuranceType" [(ngModel)]="form.insuranceType" (ngModelChange)="validateForm()" name="insuranceType">
                <option value="" disabled selected>Select Insurance Type</option>
                <option value="full">Full Type</option>
                <option value="third-party">Third Party</option>
            </select>
            <div class="error-message" *ngIf="errors['insuranceType']">{{ errors['insuranceType'] }}</div>
        </div>
        </div>

        <div class="form-row">
          <div class="form-field-row">
            <label for="phoneNo">Phone Number</label>
            <input type="text" id="phoneNo" [(ngModel)]="form.phoneNo" (ngModelChange)="validateForm()" name="phoneNo" />
            <div class="error-message" *ngIf="errors['phoneNo']">{{ errors['phoneNo'] }}</div>
          </div>

          <div class="form-field-row">
            <label for="premiumAmt">Premium Amount</label>
            <input type="number" id="premiumAmt" [(ngModel)]="form.premiumAmt" (ngModelChange)="validateForm()" name="premiumAmt" />
            <div class="error-message" *ngIf="errors['premiumAmt']">{{ errors['premiumAmt'] }}</div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-field-row">
            <label for="fromDate">From Date</label>
            <input type="date" id="fromDate" [(ngModel)]="form.fromDate" (ngModelChange)="validateForm()" name="fromDate" />
          </div>

          <div class="form-field-row">
            <label for="toDate">To Date</label>
            <input type="date" id="toDate" [(ngModel)]="form.toDate" (ngModelChange)="validateForm()" name="toDate" />
            <div class="error-message" *ngIf="errors['toDate']">{{ errors['toDate'] }}</div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-field-row">
            <label for="underwriterId">Underwriter</label>
            <select id="underwriterId" [(ngModel)]="form.underwriterId" name="underwriterId" (ngModelChange)="validateForm()">
              <option [ngValue]="''" disabled>Select Underwriter</option>
              <option *ngFor="let uw of underwriters" [ngValue]="uw.underwriterId">{{ uw.underwriterId }} - {{ uw.name }}</option>
            </select>
            <div class="error-message" *ngIf="errors['underwriterId']">{{ errors['underwriterId'] }}</div>
            <div class="error-message" *ngIf="underwriters.length === 0">No underwriters available. Please add one first.</div>
          </div>
        </div>

        <div style="text-align: center;">
          <button type="submit" class="btn">Create Policy</button>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- Success Popup -->
<div id="popup" class="popup" *ngIf="showSuccess || showFail">
  <div class="popup-content">
    <ng-container *ngIf="showFail">
      <div class="popup-overlay">
        <div class="popup-box">
          <img src="assets/images/warning.gif" alt="warning" />
          <p>Policy creation failed. Please recheck the form inputs.</p>
          <button (click)="closePopup()">Close</button>
        </div>
      </div>
    </ng-container>

    <ng-container *ngIf="showSuccess">
      <div class="popup-overlay">
        <div class="popup-box">
          <img src="assets/images/verified.gif" alt="Success" />
          <p>Policy creation Successful.</p>
          <button (click)="closePopup()">Close</button>
        </div>
      </div>
    </ng-container>

    

    <button class="btn" (click)="closePopup()">OK</button>
  </div>
</div>
